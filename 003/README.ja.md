# 003
過去の問題で見られたようなひっかけは003にはありません.

## ワンタイムパッド
ワンタイムパッド(OTP: one-time pad)は, *正しく運用されている限り*,
安全です.

OTPが安全でなくなってしまうケースは多く存在します.

たとえば, 二つのメッセージを同じ鍵で暗号化してしまうと,
安全性(secrecyだから機密性?)が損なわれてしまいます.
なぜかというと, 鍵を*再使用*しているからです.

この問題では, これについてとりあげますが, とても単純化しています.

どうして安全性が損なわれるのかわかる人は, この問題は飛ばして構いません.

最初はもっと難しい問題を作る予定でしたが,
それをする知識と技術が欠けていたことに気が付きました.
精進します.

## 問題
あなたは平文 `known_plain` (Pa)と暗号文`known_cipher` (Ca)の組を持っています.
暗号文はOTP(真にランダムな鍵を用いたバーナム暗号)で暗号化されています.

別の暗号文`unknown_cipher` (Cb)が同じ鍵によって暗号化されていることがわかりました.

つまり, この暗号はもはやOTPではありません.

あなたがすべきことはCbの平文 Pb を復元することです.

`known_plain`はただのテキストファイルです.
二つの暗号文は単に`fwrite(text, 1, text_len, fp)`しただけです.

### 注意
鍵を知らない限り, Pbのすべての内容を復元することはできません.

ですが, これが一つの問題の答えです.

### より難しい問題
ローレンツ暗号の解読はこの問題に関連しています.

ローレンツ暗号はOTPではありません.

難易度はVery Hardだと思います(全然わからん).

## バーナム暗号とRC4
バーナム暗号はストリーム暗号です.

もしこの暗号が真にランダムな鍵ストリームをたった一度きりだけ使用していれば,
OTPになります.

しかし, この問題では, 筆者はRC4を使いました.
RC4はバーナム暗号に似た暗号ですが, 疑似乱数鍵ストリーム(訳わからん)を使用します
(つまり真にランダムではない).

なぜかって?

この問題ではRC4をバーナム暗号とみなして構いません.

RC4のキースケジューリングアルゴリズムや疑似乱数生成アルゴリズムのような
アルゴリズムの詳細について考える必要はありません.

### 注意
RC4には複数の脆弱性が見つかっており,
現在では安全でないストリーム暗号と考えられています.

RC4を使うこと自体危険(で合ってるよね？)ですので,
セキュリティ対策でRC4を使用してはいけません.

## 履歴
* 2019-12-17: 公開
